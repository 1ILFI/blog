@inherits LayoutComponentBase

@inject AdminAuthService AuthService
@inject IJSRuntime JS
@inject NavigationManager NavigationManager

<FluentLayout>
    <HeaderComponent Visible="true" />

    <FluentStack Orientation="Orientation.Horizontal" Width="100%">
        <FluentBodyContent>
            <FluentMessageBarProvider 
                Section="MESSAGES_TOP" 
                ClearAfterNavigation="true" 
                MaxMessageCount="3"
                NewestOnTop="true" 
                Type="MessageType.MessageBar" />
            @Body
        </FluentBodyContent>
    </FluentStack>

    <FluentFooter>
        <p>Footer Content</p>
    </FluentFooter>
</FluentLayout>

@if (showAdminIcon)
{
    <div class="admin-icon" @onclick="NavigateToAdmin" title="管理后台">
        <FluentIcon Value="@(new Icons.Regular.Size24.Settings())" />
    </div>
}

<NavMenu />

<!-- 注意: FluentUI提供者组件已经在App.razor中注册 -->

@code {
    private bool showAdminIcon = false;

    protected override async Task OnInitializedAsync()
    {
        // 检查是否已登录管理员
        showAdminIcon = await AuthService.IsLoggedInAsync();
    }

    private void NavigateToAdmin()
    {
        NavigationManager.NavigateTo("/admin");
    }
}
