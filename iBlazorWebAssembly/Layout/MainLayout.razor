@inherits LayoutComponentBase

@inject AdminAuthService AuthService
@inject IJSRuntime JS
@inject NavigationManager NavigationManager

<FluentLayout>
    <HeaderComponent Visible="true" />

    <FluentStack Orientation="Orientation.Horizontal" Width="100%">
        <FluentBodyContent>
            <FluentMessageBarProvider 
                Section="MESSAGES_TOP" 
                ClearAfterNavigation="true" 
                MaxMessageCount="3"
                NewestOnTop="true"
                Type="MessageType.MessageBar" />
            @Body
        </FluentBodyContent>
    </FluentStack>

    <FluentFooter>
        <p>Footer Content</p>
    </FluentFooter>
</FluentLayout>

@if (showAdminIcon)
{
    <div class="admin-icon" @onclick="NavigateToAdmin" title="管理后台">
        <FluentIcon Value="@(new Icons.Regular.Size24.Settings())" />
    </div>
}

<NavMenu />

<style>
    .admin-icon {
        position: fixed;
        bottom: 20px;
        right: 20px;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background-color: #1a237e;
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        z-index: 1000;
        transition: transform 0.2s, background-color 0.2s;
    }

    .admin-icon:hover {
        transform: scale(1.1);
        background-color: #303f9f;
    }
</style>

@code {
    private bool showAdminIcon = false;

    protected override async Task OnInitializedAsync()
    {
        // 检查是否已登录管理员
        showAdminIcon = await AuthService.IsLoggedInAsync();
    }

    private void NavigateToAdmin()
    {
        NavigationManager.NavigateTo("/admin");
    }
}
